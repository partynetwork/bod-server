import { createWorker } from 'tesseract.js';

const buffer =
  'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAASCAYAAADyiPTBAAAAAXNSR0IArs4c6QAAFHtJREFUaEPlWwdUVOe2/s4UBASxoeCNoCYriiBGBaPeJGIUY+KNJYolxo49oKIi9k4RxSiIgonGKHaxYxRLjCZ2fTHRZD0VjS0WbNhghpl5b+9zzsw/BWPuuvett9Y9a+HAnHP+sv9vf/vb+/+VukWEW0p1Gjx5UYziEiPMFjP0Oh0kSUIpLLC7JIn/pH8d7tg/5uq+5WVv2Hfzf/qXBJ4rTYiHKFkg8Qz/iYva+iuvqQ+7MI3dV8of8ocyPhqy+f+pTf+KDf7Fz0rvNgmyXL9+B0VPnsNQaoLFbIZWkmAGUCIpBrMulG25eO2Fwaim5e/EhSWgKAuhfqjPOrUhro+42C9ZeMXHxB7KHlcZxtNqNTCbLQxoa3uvghVJgsQ2sjn6n3r7Ky6g6+4tPE6NJEGr08BgNDk5kCsT8gIoLGS9r9jUalrX3GVHXI7O6jjGv+LMTvMry95lrb2CMX5NmR89KlWQdBaLxQKTCl5l7iZYYLAC2pmzXBKuYjQVFMR88nMOo2WQKzAXQKQCyukVMSQ4sKC1ZQePkl4SQxzHpdVqUVpqgkYjW89M3vzSGKTGKdkBmOGViwD3r7hEG6rtyeOW29frtDAYjTZHFroVndxxLC5Hp5COdRaOTOWKuYSG1f4cncmRsJzGYrdmQuQvw1PsnE/FhMOn5AUtv24WAS0BZp0GRpMJZgVlothwArMEVPOthrfffhvlypXjkZUaS3Hs2DHcuXPbRtnCi9QpSZv69YPh5+eH/Py9MJvNqFq1KkJCGuDXXy/gzp078PT0ROPGTfhz7949djYRwayohjJDvmpcaqdRo8YoX768tT0V0CpTv9WoEV6vU8chBgE3btzAsWNHbYysgFl12n+XqhKdRgU1AbrEaJSJ1ynUOURJxWoim6me4BThFKO2atUKVapW5cdevHiO/L35MBgMzr6qoOy1115DeFg4tCRXlaeePn2KEyeO48GDB/ibel+rxa1bN3Hy5EkYS0vh7eWFhg3fwu3bt3Hp0iX5zVeJzq6cjsixvKRxIkRaWJ27G56XlMBgMsvtMzMS7wnuo/z6/vvvY8SIz1G5cmVs3LiBxzRmzFgcPfojUlNT8dO5n7gNR2bUu7mxEQICA7F+3VqYzGZ07dIV06ZNx5gxcdibvxfeXt5oGdGSP9etW2vt/c/CmxVcYmgCEBgQgMWLM1G7dh2EhNTneWk1MkPTvE0mM9/v168fvv76a5w/f57n06RJE4SHhyM5ORnbt2/Ds2fPmJ2pn38XkG3MrEYBCyRJwyytMrRjyHXCtrJGfyrNlOcqVqyIqKgoJCRMYJIhUvn44w44cOAAMjLScfXqVZcBaOiQoUhMSsL2bdsYrBYJePzoEfbt38dtLFqYjg8//BA//fQTatZ8DZMmTeJ7rSJaYdSo0ZgzZzZOnDxh37YgJcQbTlFGjE7eer3FQtpZCLJ6dz0kjYSnJQaYzJSE2ABtEwtyF2FNwpCens6LGtWtK27dvMnf16nzOvbs2cuGmDhpIgoL7wlK0zYCjtAqIiRgUPQgTJw4CUOGDGaD0qUukshEDirENl/xhviu0lBAYAAyRUADkBnaDK1WsgK6V69e+PTTnsjLy+O2fXx8sHRpFsLCwtCnT2+OPpD0sFhMlJ0B0LhcaMDMIBRlCQHSwu+82sUMTXKI5ZksO1SGlr9zbkfMBxwiu5XRd2zfgXPnziEtbT7u33/AjTRq3BhZS7Nw69Yt9O79GbPyyJEjGeDx8ePw5VdfOoMOQEpyCrpGdUX//v3x/fff2+VRjRs3xoYNm3D8xHFkLV2KBQsW4Ns9e5A6NwVJScm4c+cukpMTUVxcbG3b0VEdZ+jEwsoDUiUvT4vJYITJSAa2QNJpoXPTMoIfv3ghZ/xCUsgMrRiRjDt06DBMnToNY8eORU7OKrsSyOjRcSgsvI89e75FUFB9LF++HCazCRW8K+CPP/5ATGwMOnfqzJ4b2jAUQfXqYteu3ahevTooXM2YMR1btmzBkiVLEBAQiJAGwTxskgsZ6Rno2jWKDf748WO0aNEct1neAF7ly2Nz7hY0DW/K9z08PHghEhLGw9/Pz56hXxHQ1G79+vWRl7cbmzZtwqRJk2EsdUO5clrMmD4J0dEDYDSWQq/XY/+Bg4iOHsKMPy81Gc2bN4Obmxs7hUajQUbGYrRr9wFq1arFz69atQoTJkxg1ifJNmPGDAwaNAilpXJ7RAqDBw/Co0eP4OHhzhFs8OAhPLfC+4Xw9vbGdwcPonef3vx+zOcxmDx5ilUiZGYuRuq8VDx/9swOF+fP/8qSIH58PO7euWtbOwdSGDZsGObNm89tTJ8+za4NepRkxvp1G3g+n38+ApcuX+LiQlFREYxGI955512sWbOG55mbm4vsZcvwyy+/cLRLS0vDxIkTceb0aatjOoFVcNg/k/eSt6eHhTzcVGLk6oZGr2WXN5aaUFwqJx2O9KcyZqVKlTF79hx89NFH6NixA86RtBDogplIYcaIiFY8KQrhQ4cOQUHBZVTw8cG0qdMZ0A0bhvICREdHyww9dAjy9+5hIFsBHRLMoJiflob2H7XH8BHDcerkScyfPx9NmoTh739vgRcvXrDxW7dujS5dPsHZ/zqL2bNmIyYmFsOGDcUPPxz5pwH9+uuvIzd3C2u9/v0Hw2jSYlB0X3w+YghiYkkiHcQnnTsgLS0ZS5dkIys7G/NSU/DJJ52QmJiIjRs2YG5qKs93/br1iImJQUxsLEaMGI6xY8dh+/btGDhwIGJjYzBq1Cjs3r0bnTp1wsKFC5GVlYUvvliA0aNHM4nMnDEdGzdv4rn17z8Am3M3Y+DAAWy/yZOmYP78echckomBA6MRNzoOS5ZkYuGihWgY2hCBtQI5anyx4AtcvHgRq1evYmchOcA6VkBN5UqVWUoQ8fTt1xff7t7NcBATwUaNGmHd2vXw8vLC2bNnodPpUK9ePWb+1TmrUb1adbbbhQvnmViSk1I48gUH18eZs2dx5MgRVKzog4cPH+LEiRN4UvTEOeQIyZ+dvzlEKEmr1VoIhJQTerppmUEoEXxWYoBZUazWhNCagcj9+fpWQ1raAk4Gg4LqwmQyyTNVgCxLFTlUtmwZwZp0xYoVSElJ5vBC4CS2KRPQ+XtlQGcSQwcwQ4eHN8Wy7GW4eOkioqK6su1DQ0MRFhaO/H35ePrkKch5TKZSnDp1ikFD+pf6J8anxbPT0H+BoUl3r127lqNHly7dYCwFmrdojqpVqiI3dxsmTx7Pujyi5TvIy9uDuDHjMDdlDsLDw9AqIoLZNj4+Hl2jojAydiQDuGOnTpg3LxWpqfOxenUOP1upkg+2bt2KyZMnIzg4GBEREcjL24VJkyZi5cpV7Pg9e3TDo8eP0a7dh8jKysahQ99h7Lix+OrL5fD19UWbyNYMjLp16yIzMxM+PhXZ4Zs3b8Hf0TpPnToVV69e4ShIUe6HH3/EL7/8bAUTRbYhQ4ZiTNwY7Ny5A8OHD3POFySghr8/2kRG4tmz59i/fx+3PTcllYkuLm401q1bh7i4MSCmp+SPcHLmzGkeCyXZtDbHjx9Dq1bvY9asmchZkyOPwaFsIuaKdvdFsGs0GguFDG2pCR6ebvyc0WTGcyGjFSscoutQAjFz5ix06NARPXr2wLGjVAGQ67myG9sqtLQoy5evwIIvFmDRooV826eCDdBvvUUMbWRGoRBELE5JYWBAIDKtgA7BBx+0RdbSbBw8eAADBvSX5yWW/gBmtwH9B7LUoJB85swZ9OvbD4mJc7Bq9WpFQ9eWk8I/AfSuvDx2GtLZ9eoFYePGjbhw4QL69u2H4mIjIiM/wJQpE+BT0Ycz9m+/zUfr1hE4evQYxo0bh+SkRJZTH7Zrx6E5ftw4BnRsbCx27dyJzp07I2XuXMyfNw/LV6zg8EzArVSpEkuJnTt3ok2bNqzZZ86cga1bt8lRbsggPC4qQrPmLZCdlc2RaMKEBGzYsBGhDUJx/fp1rhqRE1EViTRxUFA9u3WxSo74eNy9d9epfh8dPQjTpk7Fvn37WBKpks6xfGbHc8rNT3t+ivT0DCxYkMYJH1WXqBJCdiRJOWvWHAZxzYAA6LQ6dpat27bh5o2bGDkyBjeVXEzEkoo9J2ALhRFJkjQWT3c36NXEA2Awl5psSYsMGLkZkhFiEtKjRw8kJ89lsGRnZ9u51cqV36Bp06acXBFDWAG9UAG0yNBvNZQlhwDo/Px8ZmYV0A0ahKBt27bMSN9/fwh9+/ZhJ/Zwd+fFJw1KbJyVtQw3bt5AZGQbHnPfPv2wePFiJCYlMkOrSSGFPLp0OtdJYU8lKaQqiHu5cixriD1ycnJY5/pV90P2smxUreqLdu0+4v6bNXsbGRmLcPr0aRnQycloEBKCdiqg4+O5ikCA3p2Xx5IiOSUFc+fOZfCStCCGbdmyJUeCFi1asF2pPWJskm1UCiV5QYBu07oNli37EoePHOYcYU3OGty7V4i+/frgxfPnDKAKFSqw01NIt14ScOTwD8yUM2fNRGFhoZUV3T3cMSFhArPqrl07eR43bly3kaJDmcHd3Z3lhsFoYN1MV/du3TkSUgKYmDjb2q3mfxNw0vdNw8N5DmvXruM8i8jpq+XL4VXeiyUYRQ6xLKsSpMKTIq/aEZqk0+ksHm566DVAqcXCQDaY5B1D+0vmdWtBQilZBQUFsWYl76PEhZIMuiIj27KhDxzYj4QJCZwUrnBkaBcamsplJENGjxqJbdu3OwG6Zs2anFTVql0LPbp3w9Xff8eokaM5KaWfa9d+R3Y2JR0/s66nWuq81Pn47LPPMHXa1JcA2r5sZ6ty7IZep2fdmZGRAYpKw4cNx88/n0Pt2rWZVUkz/qN9e2bEocOGsawg9h0/fjySkpJQPzgYkW0iQWVKAl23qCiOIsT+H3/8MYOZniNAk7NQAhkZGclJ4YgRIxjIO3bswMiRsVwVoBrxwIH9cerUaQwfPpwBsmnzJoweNQoJCQno0qUrho8Yhu+++w7NmjXD4oxMnL9wHn1693a1pHaamcqjJNOolJabuxkzZ85kdhcdwfq7kkw1b9YcOTlr8Ntvv2HQoIFMTImJSWjTJpKTRJJL6kUVD8q7Fmdm4kcln6FcivKGDes38v5DXFwc7t5VklTlRYc81T6aCOU9ybu8p0WnAWfoxaWlrJ9dSgx1l8qpCAiENmzImjAsPAw/HDnCQ6DaJWmnr776kidKupb0MyU2suSQ4ONTAVPFpNBoYCZLX5SOa9euIytrKY4fP84MHRgYAGJoupo2fZuZj5jhvy9eREhwCNIz0rFzxw4G17j4ePTs0RNbtuQyexJ7v/vuu1i5ciXrd9KUpIftGdoe0AMGDMD+/ftx7do1jk5vvPEGfxL4KPwbDQZmvk979WJteOTwYej0epDD0bNXrlzBZ716Yc6cOQzotpHtoNNrkTA+HlHdunFyRwzdvn17rtUnJSfz+KjsRYA6fPgwsytFKGqP6r+tWkWgXt16mD1nDmoFBuLcz+cQHBKCgJoB+OabbxA/fhw72ZTJUzivOXToEIf0osdFPG9yQvWylkAddOp7773Hko4IijayqIasXj8ePcqJY8+ePXH61ClORNWrY4eODFSyl8FQggYNQjE+IZ5tSPVouojFKfml/QqSR1QB6datO6gadvv2H5wvkcPv3LXTGi3sNllEd3TYX1BvSVUqVrBQglZsNNqxrygxZLpXtl3FoqbwO+lhf39/qzShTRLSQRQ2yUFIQ9WoUQP3H9zHIwp9fA5C4vBavrwXrl4pYDnj4eHJ7RBLPXj4gHeZqNRG7FZwucAqaapX90PFShV5aGSYgsuX+X1aKEo2/fz9oNXImxAUBsmYT54+w717d1kq6N30KCig9gCdsvWtbqyQ5iQmFis2VBUgSXHn9m1mYnIcSn7KlXNHjb/5c7mM+qYqCyfWJhOu37iBKlWqQK93Y01LZzB8favy+O4VFuJJURHbhXZH79+/z99ROzR/uT2LtT0ay5WCAmi0Gm6jmq8vV6KI8YjByelJ6tBF+rtatepcu6ZIS3Li/oMHslxUVt4FL/EdygP8/P15fg41AK6EPHn6BH5+/mzTuwLY6d3AwFrw9PRgxjeUGHC54LIMHaVP1s9+1VFSXMLrSuMp5+7O83Uv586FAtpFLCkxuD4oJAJaaFick+Rd3sPyvLjYunkhv0NgU5xE0Bh8jqAMS/DiO1hAfFysH/ImAZ+ZsDVmvS+c1XDcEBD3RNVhqWcbnOYqdGhX13Q8C2JRNbSNoakt+74l6HR61toEVAaGRt5IoUUS56aOg8/HkGzjnURyNEpE5F1JchwCPX1HpxvlA0dyeyWGEmvvjudCyPkpurz55pvo3j2KoymxMR0VaBnxHjOx0yUMztU4xbk6bsPaJX8iMsvyBrFz5eWy+rTaSR2AUKlwAGPZx2ocGycT+1bxsTwqemIFF+9EOfUmz0YEj7rtqz4qA1oGvJOYtz4knksTqiHOy6D6lYttfZuakredld5EkaWA1mlr2tFZlOqIeJaDtr5doYIycWJHFZzULTEuzZvAabe1bAGXDWVukAdGgOVzMcoRALu1V9qgdkh/ms0mxeHNTmWy0NAGvKlSrZovRwpidtqpJVknN25r+aUYEXQnY8oVSMs40SaO3dWOpLDcZa2s9XvnipgL/DrIIidSFcYpffKPdywPHhah4OofePj4KUpNJt5WtdsgsQO4bfPbqrVdUlQZB6eF+CCeC+Gv1RNGjhYRrU0gUu7LzCu0omJbpHuHMqLNksqWOrOmfIaDTtvxMVKHZaDmtBodh3BiVxqO+pzEVR+bp6ggIrDJc4IMeEgMaFUWqdUi2RlksuANLnYoeQeAdsdlhxUimUTsLrdJh3v+0iVMzNXZDldAdBXd7OzjCLZXGJDIPWUeznmVKOCKemr4V7JUreyDOoH+qODtxWGVmOc/6rKzcBkzFxzJwb/tXhAtR67h6j8LqI7IeYTgnLJicxFxHIfkrO7+o5brZZP9H9fAtYqCN2MQAAAAAElFTkSuQmCC';

function sanitizeValueStat(text: string): number {
  // remove whitespace and special characters and replace with empty string
  const sanitizedText = text
    .replace('%', '')
    .replace(/[^0-9.]/g, '')
    .trim();
  return parseFloat(sanitizedText);
}

describe('Test AppService', () => {
  test('extract base64 image data', async () => {
    const worker = await createWorker('eng');
    const fileBuffer = Buffer.from(buffer.split(',')[1], 'base64');
    const recognizeResult = await worker.recognize(fileBuffer);
    await worker.terminate();
    let text = recognizeResult.data.text;
    console.log(sanitizeValueStat(text));
  }, 10000);
});
